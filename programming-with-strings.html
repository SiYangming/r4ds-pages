<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>37 Programming with strings | R for Data Science (2e)</title>
<meta name="author" content="Hadley Wickham and Garrett Grolemund">
<meta name="description" content="You are reading the work-in-progress second edition of R for Data Science. This chapter is currently currently a dumping ground for ideas, and we don’t recommend reading it. You can find the...">
<meta name="generator" content="bookdown 0.23 with bs4_book()">
<meta property="og:title" content="37 Programming with strings | R for Data Science (2e)">
<meta property="og:type" content="book">
<meta property="og:url" content="https://r4ds.had.co.nz/programming-with-strings.html">
<meta property="og:image" content="https://r4ds.had.co.nz//cover.png">
<meta property="og:description" content="You are reading the work-in-progress second edition of R for Data Science. This chapter is currently currently a dumping ground for ideas, and we don’t recommend reading it. You can find the...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="37 Programming with strings | R for Data Science (2e)">
<meta name="twitter:site" content="@hadley">
<meta name="twitter:description" content="You are reading the work-in-progress second edition of R for Data Science. This chapter is currently currently a dumping ground for ideas, and we don’t recommend reading it. You can find the...">
<meta name="twitter:image" content="https://r4ds.had.co.nz//cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-115082821-1');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R for Data Science (2e)</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="preface-to-the-second-edition.html">Preface to the second edition</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li class="book-part">Whole game</li>
<li><a class="" href="explore-intro.html"><span class="header-section-number">2</span> Introduction</a></li>
<li><a class="" href="data-visualisation.html"><span class="header-section-number">3</span> Data visualisation</a></li>
<li><a class="" href="workflow-basics.html"><span class="header-section-number">4</span> Workflow: basics</a></li>
<li><a class="" href="data-transform.html"><span class="header-section-number">5</span> Data transformation</a></li>
<li><a class="" href="data-tidy.html"><span class="header-section-number">6</span> Data tidying</a></li>
<li><a class="" href="workflow-pipes.html"><span class="header-section-number">7</span> Workflow: pipes</a></li>
<li><a class="" href="data-import.html"><span class="header-section-number">8</span> Data import</a></li>
<li><a class="" href="workflow-scripts.html"><span class="header-section-number">9</span> Workflow: scripts</a></li>
<li><a class="" href="exploratory-data-analysis.html"><span class="header-section-number">10</span> Exploratory Data Analysis</a></li>
<li><a class="" href="workflow-projects.html"><span class="header-section-number">11</span> Workflow: projects</a></li>
<li class="book-part">Transform</li>
<li><a class="" href="data-types-intro.html"><span class="header-section-number">12</span> Introduction</a></li>
<li><a class="" href="tibbles.html"><span class="header-section-number">13</span> Tibbles</a></li>
<li><a class="" href="relational-data.html"><span class="header-section-number">14</span> Relational data</a></li>
<li><a class="" href="vector-tools.html"><span class="header-section-number">15</span> Vector tools</a></li>
<li><a class="" href="logicals-numbers.html"><span class="header-section-number">16</span> Logicals and numbers</a></li>
<li><a class="" href="missing-values.html"><span class="header-section-number">17</span> Missing values</a></li>
<li><a class="" href="strings.html"><span class="header-section-number">18</span> Strings</a></li>
<li><a class="" href="regular-expressions.html"><span class="header-section-number">19</span> Regular expressions</a></li>
<li><a class="" href="factors.html"><span class="header-section-number">20</span> Factors</a></li>
<li><a class="" href="dates-and-times.html"><span class="header-section-number">21</span> Dates and times</a></li>
<li><a class="" href="column-wise.html"><span class="header-section-number">22</span> Column-wise operations</a></li>
<li class="book-part">Import</li>
<li><a class="" href="import-intro.html"><span class="header-section-number">23</span> Introduction</a></li>
<li><a class="" href="import-rectangular.html"><span class="header-section-number">24</span> Rectangular data</a></li>
<li><a class="" href="import-spreadsheets.html"><span class="header-section-number">25</span> Spreadsheets</a></li>
<li><a class="" href="import-databases.html"><span class="header-section-number">26</span> Databases</a></li>
<li><a class="" href="import-webscrape.html"><span class="header-section-number">27</span> Web scraping</a></li>
<li><a class="" href="import-other.html"><span class="header-section-number">28</span> Other types of data</a></li>
<li class="book-part">Tidy</li>
<li><a class="" href="wrangle-intro.html"><span class="header-section-number">29</span> Introduction</a></li>
<li><a class="" href="list-columns.html"><span class="header-section-number">30</span> List columns</a></li>
<li><a class="" href="rectangle-data.html"><span class="header-section-number">31</span> Data rectangling</a></li>
<li class="book-part">Program</li>
<li><a class="" href="program-intro.html"><span class="header-section-number">32</span> Introduction</a></li>
<li><a class="" href="pipes.html"><span class="header-section-number">33</span> Pipes</a></li>
<li><a class="" href="functions.html"><span class="header-section-number">34</span> Functions</a></li>
<li><a class="" href="vectors.html"><span class="header-section-number">35</span> Vectors</a></li>
<li><a class="" href="iteration.html"><span class="header-section-number">36</span> Iteration</a></li>
<li><a class="active" href="programming-with-strings.html"><span class="header-section-number">37</span> Programming with strings</a></li>
<li class="book-part">Communicate</li>
<li><a class="" href="communicate-intro.html"><span class="header-section-number">38</span> Introduction</a></li>
<li><a class="" href="r-markdown.html"><span class="header-section-number">39</span> R Markdown</a></li>
<li><a class="" href="graphics-for-communication.html"><span class="header-section-number">40</span> Graphics for communication</a></li>
<li><a class="" href="r-markdown-formats.html"><span class="header-section-number">41</span> R Markdown formats</a></li>
<li><a class="" href="r-markdown-workflow.html"><span class="header-section-number">42</span> R Markdown workflow</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/hadley/r4ds">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="programming-with-strings" class="section level1" number="37">
<h1>
<span class="header-section-number">37</span> Programming with strings<a class="anchor" aria-label="anchor" href="#programming-with-strings"><i class="fas fa-link"></i></a>
</h1>
<div class="rmdnote">
<p>You are reading the work-in-progress second edition of R for Data Science. This chapter is currently currently a dumping ground for ideas, and we don’t recommend reading it. You can find the polished first edition at <a href="https://r4ds.had.co.nz" class="uri">https://r4ds.had.co.nz</a>.</p>
</div>
<div class="sourceCode" id="cb627"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://stringr.tidyverse.org">stringr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/">tibble</a></span><span class="op">)</span></code></pre></div>
<div id="str_c" class="section level3" number="37.0.1">
<h3>
<span class="header-section-number">37.0.1</span> str_c<a class="anchor" aria-label="anchor" href="#str_c"><i class="fas fa-link"></i></a>
</h3>
<p><code>NULL</code>s are silently dropped.
This is particularly useful in conjunction with <code>if</code>:</p>
<div class="sourceCode" id="cb628"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">name</span> <span class="op">&lt;-</span> <span class="st">"Hadley"</span>
<span class="va">time_of_day</span> <span class="op">&lt;-</span> <span class="st">"morning"</span>
<span class="va">birthday</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span>

<span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span>
  <span class="st">"Good "</span>, <span class="va">time_of_day</span>, <span class="st">" "</span>, <span class="va">name</span>,
  <span class="kw">if</span> <span class="op">(</span><span class="va">birthday</span><span class="op">)</span> <span class="st">" and HAPPY BIRTHDAY"</span>,
  <span class="st">"."</span>
<span class="op">)</span>
<span class="co">#&gt; [1] "Good morning Hadley."</span></code></pre></div>
</div>
<div id="performance" class="section level2" number="37.1">
<h2>
<span class="header-section-number">37.1</span> Performance<a class="anchor" aria-label="anchor" href="#performance"><i class="fas fa-link"></i></a>
</h2>
<p><code><a href="https://stringr.tidyverse.org/reference/modifiers.html">fixed()</a></code>: matches exactly the specified sequence of bytes.
It ignores all special regular expressions and operates at a very low level.
This allows you to avoid complex escaping and can be much faster than regular expressions.
The following microbenchmark shows that it’s about 3x faster for a simple example.</p>
<div class="sourceCode" id="cb629"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">microbenchmark</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html">microbenchmark</a></span><span class="op">(</span>
  fixed <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">sentences</span>, <span class="fu"><a href="https://stringr.tidyverse.org/reference/modifiers.html">fixed</a></span><span class="op">(</span><span class="st">"the"</span><span class="op">)</span><span class="op">)</span>,
  regex <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">sentences</span>, <span class="st">"the"</span><span class="op">)</span>,
  times <span class="op">=</span> <span class="fl">20</span>
<span class="op">)</span>
<span class="co">#&gt; Unit: microseconds</span>
<span class="co">#&gt;   expr   min     lq    mean  median     uq    max neval</span>
<span class="co">#&gt;  fixed 194.8 263.70 448.350  348.65  440.8 2459.5    20</span>
<span class="co">#&gt;  regex 527.8 761.45 946.625 1013.35 1106.4 1280.4    20</span></code></pre></div>
<p>As you saw with <code><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split()</a></code> you can use <code><a href="https://stringr.tidyverse.org/reference/modifiers.html">boundary()</a></code> to match boundaries.
You can also use it with the other functions:</p>
<div class="sourceCode" id="cb630"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="st">"This is a sentence."</span>
<span class="fu"><a href="https://stringr.tidyverse.org/reference/str_view.html">str_view_all</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://stringr.tidyverse.org/reference/modifiers.html">boundary</a></span><span class="op">(</span><span class="st">"word"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; &lt;U+2029&gt;[36m&lt;This&gt;&lt;U+2029&gt;[39m &lt;U+2029&gt;[36m&lt;is&gt;&lt;U+2029&gt;[39m &lt;U+2029&gt;[36m&lt;a&gt;&lt;U+2029&gt;[39m &lt;U+2029&gt;[36m&lt;sentence&gt;&lt;U+2029&gt;[39m.</span>NA<span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract_all</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://stringr.tidyverse.org/reference/modifiers.html">boundary</a></span><span class="op">(</span><span class="st">"word"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] "This"     "is"       "a"        "sentence"</span></code></pre></div>
<div id="section" class="section level3" number="37.1.1">
<h3>
<span class="header-section-number">37.1.1</span> <a class="anchor" aria-label="anchor" href="#section"><i class="fas fa-link"></i></a>
</h3>
</div>
<div id="extract" class="section level3" number="37.1.2">
<h3>
<span class="header-section-number">37.1.2</span> Extract<a class="anchor" aria-label="anchor" href="#extract"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb631"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">colours</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"orange"</span>, <span class="st">"yellow"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"purple"</span><span class="op">)</span>
<span class="va">colour_match</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="va">colours</span>, collapse <span class="op">=</span> <span class="st">"|"</span><span class="op">)</span>
<span class="va">colour_match</span>
<span class="co">#&gt; [1] "red|orange|yellow|green|blue|purple"</span>

<span class="va">more</span> <span class="op">&lt;-</span> <span class="va">sentences</span><span class="op">[</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_count.html">str_count</a></span><span class="op">(</span><span class="va">sentences</span>, <span class="va">colour_match</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">]</span>
<span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract_all</a></span><span class="op">(</span><span class="va">more</span>, <span class="va">colour_match</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] "blue" "red" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1] "green" "red"  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [1] "orange" "red"</span></code></pre></div>
<p>If you use <code>simplify = TRUE</code>, <code><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract_all()</a></code> will return a matrix with short matches expanded to the same length as the longest:</p>
<div class="sourceCode" id="cb632"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract_all</a></span><span class="op">(</span><span class="va">more</span>, <span class="va">colour_match</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt;      [,1]     [,2] </span>
<span class="co">#&gt; [1,] "blue"   "red"</span>
<span class="co">#&gt; [2,] "green"  "red"</span>
<span class="co">#&gt; [3,] "orange" "red"</span>

<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"a b"</span>, <span class="st">"a b c"</span><span class="op">)</span>
<span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract_all</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"[a-z]"</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt;      [,1] [,2] [,3]</span>
<span class="co">#&gt; [1,] "a"  ""   ""  </span>
<span class="co">#&gt; [2,] "a"  "b"  ""  </span>
<span class="co">#&gt; [3,] "a"  "b"  "c"</span></code></pre></div>
<p>We don’t talk about matrices here, but they are useful elsewhere.</p>
</div>
<div id="exercises-63" class="section level3" number="37.1.3">
<h3>
<span class="header-section-number">37.1.3</span> Exercises<a class="anchor" aria-label="anchor" href="#exercises-63"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<p>From the Harvard sentences data, extract:</p>
<ol style="list-style-type: decimal">
<li>The first word from each sentence.</li>
<li>All words ending in <code>ing</code>.</li>
<li>All plurals.</li>
</ol>
</li>
</ol>
</div>
</div>
<div id="grouped-matches" class="section level2" number="37.2">
<h2>
<span class="header-section-number">37.2</span> Grouped matches<a class="anchor" aria-label="anchor" href="#grouped-matches"><i class="fas fa-link"></i></a>
</h2>
<p>Earlier in this chapter we talked about the use of parentheses for clarifying precedence and for backreferences when matching.
You can also use parentheses to extract parts of a complex match.
For example, imagine we want to extract nouns from the sentences.
As a heuristic, we’ll look for any word that comes after “a” or “the”.
Defining a “word” in a regular expression is a little tricky, so here I use a simple approximation: a sequence of at least one character that isn’t a space.</p>
<div class="sourceCode" id="cb633"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">noun</span> <span class="op">&lt;-</span> <span class="st">"(a|the) ([^ ]+)"</span>

<span class="va">has_noun</span> <span class="op">&lt;-</span> <span class="va">sentences</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_subset.html">str_subset</a></span><span class="op">(</span><span class="va">noun</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>
<span class="va">has_noun</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">noun</span><span class="op">)</span>
<span class="co">#&gt;  [1] "the smooth" "the sheet"  "the depth"  "a chicken"  "the parked"</span>
<span class="co">#&gt;  [6] "the sun"    "the huge"   "the ball"   "the woman"  "a helps"</span></code></pre></div>
<p><code><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract()</a></code> gives us the complete match; <code><a href="https://stringr.tidyverse.org/reference/str_match.html">str_match()</a></code> gives each individual component.
Instead of a character vector, it returns a matrix, with one column for the complete match followed by one column for each group:</p>
<div class="sourceCode" id="cb634"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">has_noun</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_match.html">str_match</a></span><span class="op">(</span><span class="va">noun</span><span class="op">)</span>
<span class="co">#&gt;       [,1]         [,2]  [,3]     </span>
<span class="co">#&gt;  [1,] "the smooth" "the" "smooth" </span>
<span class="co">#&gt;  [2,] "the sheet"  "the" "sheet"  </span>
<span class="co">#&gt;  [3,] "the depth"  "the" "depth"  </span>
<span class="co">#&gt;  [4,] "a chicken"  "a"   "chicken"</span>
<span class="co">#&gt;  [5,] "the parked" "the" "parked" </span>
<span class="co">#&gt;  [6,] "the sun"    "the" "sun"    </span>
<span class="co">#&gt;  [7,] "the huge"   "the" "huge"   </span>
<span class="co">#&gt;  [8,] "the ball"   "the" "ball"   </span>
<span class="co">#&gt;  [9,] "the woman"  "the" "woman"  </span>
<span class="co">#&gt; [10,] "a helps"    "a"   "helps"</span></code></pre></div>
<p>(Unsurprisingly, our heuristic for detecting nouns is poor, and also picks up adjectives like smooth and parked.)</p>
</div>
<div id="spitting" class="section level2" number="37.3">
<h2>
<span class="header-section-number">37.3</span> Spitting<a class="anchor" aria-label="anchor" href="#spitting"><i class="fas fa-link"></i></a>
</h2>
<p>Use <code><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split()</a></code> to split a string up into pieces.
For example, we could split sentences into words:</p>
<div class="sourceCode" id="cb635"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sentences</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split</a></span><span class="op">(</span><span class="st">" "</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] "The"     "birch"   "canoe"   "slid"    "on"      "the"     "smooth" </span>
<span class="co">#&gt; [8] "planks."</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1] "Glue"        "the"         "sheet"       "to"          "the"        </span>
<span class="co">#&gt; [6] "dark"        "blue"        "background."</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [1] "It's"  "easy"  "to"    "tell"  "the"   "depth" "of"    "a"     "well."</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt; [1] "These"   "days"    "a"       "chicken" "leg"     "is"      "a"      </span>
<span class="co">#&gt; [8] "rare"    "dish."  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[5]]</span>
<span class="co">#&gt; [1] "Rice"   "is"     "often"  "served" "in"     "round"  "bowls."</span></code></pre></div>
<p>Because each component might contain a different number of pieces, this returns a list.
If you’re working with a length-1 vector, the easiest thing is to just extract the first element of the list:</p>
<div class="sourceCode" id="cb636"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="st">"a|b|c|d"</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split</a></span><span class="op">(</span><span class="st">"\\|"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="va">.</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="co">#&gt; [1] "a" "b" "c" "d"</span></code></pre></div>
<p>Otherwise, like the other stringr functions that return a list, you can use <code>simplify = TRUE</code> to return a matrix:</p>
<div class="sourceCode" id="cb637"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sentences</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split</a></span><span class="op">(</span><span class="st">" "</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt;      [,1]    [,2]    [,3]    [,4]      [,5]  [,6]    [,7]     [,8]         </span>
<span class="co">#&gt; [1,] "The"   "birch" "canoe" "slid"    "on"  "the"   "smooth" "planks."    </span>
<span class="co">#&gt; [2,] "Glue"  "the"   "sheet" "to"      "the" "dark"  "blue"   "background."</span>
<span class="co">#&gt; [3,] "It's"  "easy"  "to"    "tell"    "the" "depth" "of"     "a"          </span>
<span class="co">#&gt; [4,] "These" "days"  "a"     "chicken" "leg" "is"    "a"      "rare"       </span>
<span class="co">#&gt; [5,] "Rice"  "is"    "often" "served"  "in"  "round" "bowls." ""           </span>
<span class="co">#&gt;      [,9]   </span>
<span class="co">#&gt; [1,] ""     </span>
<span class="co">#&gt; [2,] ""     </span>
<span class="co">#&gt; [3,] "well."</span>
<span class="co">#&gt; [4,] "dish."</span>
<span class="co">#&gt; [5,] ""</span></code></pre></div>
<p>You can also request a maximum number of pieces:</p>
<div class="sourceCode" id="cb638"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Name: Hadley"</span>, <span class="st">"Country: NZ"</span>, <span class="st">"Age: 35"</span><span class="op">)</span>
<span class="va">fields</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split</a></span><span class="op">(</span><span class="st">": "</span>, n <span class="op">=</span> <span class="fl">2</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt;      [,1]      [,2]    </span>
<span class="co">#&gt; [1,] "Name"    "Hadley"</span>
<span class="co">#&gt; [2,] "Country" "NZ"    </span>
<span class="co">#&gt; [3,] "Age"     "35"</span></code></pre></div>
<p>Instead of splitting up strings by patterns, you can also split up by character, line, sentence and word <code><a href="https://stringr.tidyverse.org/reference/modifiers.html">boundary()</a></code>s:</p>
<div class="sourceCode" id="cb639"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="st">"This is a sentence.  This is another sentence."</span>
<span class="fu"><a href="https://stringr.tidyverse.org/reference/str_view.html">str_view_all</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://stringr.tidyverse.org/reference/modifiers.html">boundary</a></span><span class="op">(</span><span class="st">"word"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; &lt;U+2029&gt;[36m&lt;This&gt;&lt;U+2029&gt;[39m &lt;U+2029&gt;[36m&lt;is&gt;&lt;U+2029&gt;[39m &lt;U+2029&gt;[36m&lt;a&gt;&lt;U+2029&gt;[39m &lt;U+2029&gt;[36m&lt;sentence&gt;&lt;U+2029&gt;[39m.  &lt;U+2029&gt;[36m&lt;This&gt;&lt;U+2029&gt;[39m &lt;U+2029&gt;[36m&lt;is&gt;&lt;U+2029&gt;[39m &lt;U+2029&gt;[36m&lt;another&gt;&lt;U+2029&gt;[39m &lt;U+2029&gt;[36m&lt;sentence&gt;&lt;U+2029&gt;[39m.</span>NA<span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">" "</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="co">#&gt; [1] "This"      "is"        "a"         "sentence." ""          "This"     </span>
<span class="co">#&gt; [7] "is"        "another"   "sentence."</span>
<span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://stringr.tidyverse.org/reference/modifiers.html">boundary</a></span><span class="op">(</span><span class="st">"word"</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="co">#&gt; [1] "This"     "is"       "a"        "sentence" "This"     "is"       "another" </span>
<span class="co">#&gt; [8] "sentence"</span></code></pre></div>
<p>Show how <code><a href="https://tidyr.tidyverse.org/reference/separate_rows.html">separate_rows()</a></code> is a special case of <code><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split()</a></code> + <code>summarise()</code>.</p>
</div>
<div id="replace-with-function" class="section level2" number="37.4">
<h2>
<span class="header-section-number">37.4</span> Replace with function<a class="anchor" aria-label="anchor" href="#replace-with-function"><i class="fas fa-link"></i></a>
</h2>
</div>
<div id="locations" class="section level2" number="37.5">
<h2>
<span class="header-section-number">37.5</span> Locations<a class="anchor" aria-label="anchor" href="#locations"><i class="fas fa-link"></i></a>
</h2>
<p><code><a href="https://stringr.tidyverse.org/reference/str_locate.html">str_locate()</a></code> and <code><a href="https://stringr.tidyverse.org/reference/str_locate.html">str_locate_all()</a></code> give you the starting and ending positions of each match.
These are particularly useful when none of the other functions does exactly what you want.
You can use <code><a href="https://stringr.tidyverse.org/reference/str_locate.html">str_locate()</a></code> to find the matching pattern, <code><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub()</a></code> to extract and/or modify them.</p>
</div>
<div id="stringi" class="section level2" number="37.6">
<h2>
<span class="header-section-number">37.6</span> stringi<a class="anchor" aria-label="anchor" href="#stringi"><i class="fas fa-link"></i></a>
</h2>
<p>stringr is built on top of the <strong>stringi</strong> package.
stringr is useful when you’re learning because it exposes a minimal set of functions, which have been carefully picked to handle the most common string manipulation functions.
stringi, on the other hand, is designed to be comprehensive.
It contains almost every function you might ever need: stringi has 256 functions to stringr’s 53.</p>
<p>If you find yourself struggling to do something in stringr, it’s worth taking a look at stringi.
The packages work very similarly, so you should be able to translate your stringr knowledge in a natural way.
The main difference is the prefix: <code>str_</code> vs. <code>stri_</code>.</p>
<div id="exercises-64" class="section level3" number="37.6.1">
<h3>
<span class="header-section-number">37.6.1</span> Exercises<a class="anchor" aria-label="anchor" href="#exercises-64"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<p>Find the stringi functions that:</p>
<ol style="list-style-type: lower-alpha">
<li>Count the number of words.</li>
<li>Find duplicated strings.</li>
<li>Generate random text.</li>
</ol>
</li>
<li><p>How do you control the language that <code>stri_sort()</code> uses for sorting?</p></li>
</ol>
</div>
<div id="exercises-65" class="section level3" number="37.6.2">
<h3>
<span class="header-section-number">37.6.2</span> Exercises<a class="anchor" aria-label="anchor" href="#exercises-65"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<p>What do the <code>extra</code> and <code>fill</code> arguments do in <code><a href="https://tidyr.tidyverse.org/reference/separate.html">separate()</a></code>?
Experiment with the various options for the following two toy datasets.</p>
<div class="sourceCode" id="cb640"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a,b,c"</span>, <span class="st">"d,e,f,g"</span>, <span class="st">"h,i,j"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"one"</span>, <span class="st">"two"</span>, <span class="st">"three"</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a,b,c"</span>, <span class="st">"d,e"</span>, <span class="st">"f,g,i"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"one"</span>, <span class="st">"two"</span>, <span class="st">"three"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</li>
<li><p>Both <code><a href="https://tidyr.tidyverse.org/reference/unite.html">unite()</a></code> and <code><a href="https://tidyr.tidyverse.org/reference/separate.html">separate()</a></code> have a <code>remove</code> argument.
What does it do?
Why would you set it to <code>FALSE</code>?</p></li>
<li><p>Compare and contrast <code><a href="https://tidyr.tidyverse.org/reference/separate.html">separate()</a></code> and <code><a href="https://tidyr.tidyverse.org/reference/extract.html">extract()</a></code>.
Why are there three variations of separation (by position, by separator, and with groups), but only one unite?</p></li>
<li>
<p>In the following example we’re using <code><a href="https://tidyr.tidyverse.org/reference/unite.html">unite()</a></code> to create a <code>date</code> column from <code>month</code> and <code>day</code> columns.
How would you achieve the same outcome using <code>mutate()</code> and <code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code> instead of unite?</p>
<div class="sourceCode" id="cb641"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">events</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
  <span class="op">~</span><span class="va">month</span>, <span class="op">~</span><span class="va">day</span>,
  <span class="fl">1</span>     , <span class="fl">20</span>,
  <span class="fl">1</span>     , <span class="fl">21</span>,
  <span class="fl">1</span>     , <span class="fl">22</span>
<span class="op">)</span>

<span class="va">events</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html">unite</a></span><span class="op">(</span><span class="st">"date"</span>, <span class="va">month</span><span class="op">:</span><span class="va">day</span>, sep <span class="op">=</span> <span class="st">"-"</span>, remove <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
</li>
<li><p>Write a function that turns (e.g.) a vector <code><a href="https://rdrr.io/r/base/c.html">c("a", "b", "c")</a></code> into the string <code>a, b, and c</code>.
Think carefully about what it should do if given a vector of length 0, 1, or 2.</p></li>
</ol>
</div>
</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="iteration.html"><span class="header-section-number">36</span> Iteration</a></div>
<div class="next"><a href="communicate-intro.html"><span class="header-section-number">38</span> Introduction</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li>
<a class="nav-link" href="#programming-with-strings"><span class="header-section-number">37</span> Programming with strings</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#str_c"><span class="header-section-number">37.0.1</span> str_c</a></li></ul>
</li>
<li>
<a class="nav-link" href="#performance"><span class="header-section-number">37.1</span> Performance</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#section"><span class="header-section-number">37.1.1</span></a></li>
<li><a class="nav-link" href="#extract"><span class="header-section-number">37.1.2</span> Extract</a></li>
<li><a class="nav-link" href="#exercises-63"><span class="header-section-number">37.1.3</span> Exercises</a></li>
</ul>
</li>
<li><a class="nav-link" href="#grouped-matches"><span class="header-section-number">37.2</span> Grouped matches</a></li>
<li><a class="nav-link" href="#spitting"><span class="header-section-number">37.3</span> Spitting</a></li>
<li><a class="nav-link" href="#replace-with-function"><span class="header-section-number">37.4</span> Replace with function</a></li>
<li><a class="nav-link" href="#locations"><span class="header-section-number">37.5</span> Locations</a></li>
<li>
<a class="nav-link" href="#stringi"><span class="header-section-number">37.6</span> stringi</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#exercises-64"><span class="header-section-number">37.6.1</span> Exercises</a></li>
<li><a class="nav-link" href="#exercises-65"><span class="header-section-number">37.6.2</span> Exercises</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/hadley/r4ds/blob/master/prog-strings.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/hadley/r4ds/edit/master/prog-strings.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R for Data Science (2e)</strong>" was written by Hadley Wickham and Garrett Grolemund. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
