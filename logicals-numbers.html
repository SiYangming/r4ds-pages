<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>16 Logicals and numbers | R for Data Science (2e)</title>
<meta name="author" content="Hadley Wickham and Garrett Grolemund">
<meta name="description" content="You are reading the work-in-progress second edition of R for Data Science. This chapter is currently currently a dumping ground for ideas, and we don’t recommend reading it. You can find the...">
<meta name="generator" content="bookdown 0.23 with bs4_book()">
<meta property="og:title" content="16 Logicals and numbers | R for Data Science (2e)">
<meta property="og:type" content="book">
<meta property="og:url" content="https://r4ds.had.co.nz/logicals-numbers.html">
<meta property="og:image" content="https://r4ds.had.co.nz//cover.png">
<meta property="og:description" content="You are reading the work-in-progress second edition of R for Data Science. This chapter is currently currently a dumping ground for ideas, and we don’t recommend reading it. You can find the...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="16 Logicals and numbers | R for Data Science (2e)">
<meta name="twitter:site" content="@hadley">
<meta name="twitter:description" content="You are reading the work-in-progress second edition of R for Data Science. This chapter is currently currently a dumping ground for ideas, and we don’t recommend reading it. You can find the...">
<meta name="twitter:image" content="https://r4ds.had.co.nz//cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-115082821-1');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R for Data Science (2e)</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="preface-to-the-second-edition.html">Preface to the second edition</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li class="book-part">Whole game</li>
<li><a class="" href="explore-intro.html"><span class="header-section-number">2</span> Introduction</a></li>
<li><a class="" href="data-visualisation.html"><span class="header-section-number">3</span> Data visualisation</a></li>
<li><a class="" href="workflow-basics.html"><span class="header-section-number">4</span> Workflow: basics</a></li>
<li><a class="" href="data-transform.html"><span class="header-section-number">5</span> Data transformation</a></li>
<li><a class="" href="data-tidy.html"><span class="header-section-number">6</span> Data tidying</a></li>
<li><a class="" href="workflow-pipes.html"><span class="header-section-number">7</span> Workflow: pipes</a></li>
<li><a class="" href="data-import.html"><span class="header-section-number">8</span> Data import</a></li>
<li><a class="" href="workflow-scripts.html"><span class="header-section-number">9</span> Workflow: scripts</a></li>
<li><a class="" href="exploratory-data-analysis.html"><span class="header-section-number">10</span> Exploratory Data Analysis</a></li>
<li><a class="" href="workflow-projects.html"><span class="header-section-number">11</span> Workflow: projects</a></li>
<li class="book-part">Transform</li>
<li><a class="" href="data-types-intro.html"><span class="header-section-number">12</span> Introduction</a></li>
<li><a class="" href="tibbles.html"><span class="header-section-number">13</span> Tibbles</a></li>
<li><a class="" href="relational-data.html"><span class="header-section-number">14</span> Relational data</a></li>
<li><a class="" href="vector-tools.html"><span class="header-section-number">15</span> Vector tools</a></li>
<li><a class="active" href="logicals-numbers.html"><span class="header-section-number">16</span> Logicals and numbers</a></li>
<li><a class="" href="missing-values.html"><span class="header-section-number">17</span> Missing values</a></li>
<li><a class="" href="strings.html"><span class="header-section-number">18</span> Strings</a></li>
<li><a class="" href="regular-expressions.html"><span class="header-section-number">19</span> Regular expressions</a></li>
<li><a class="" href="factors.html"><span class="header-section-number">20</span> Factors</a></li>
<li><a class="" href="dates-and-times.html"><span class="header-section-number">21</span> Dates and times</a></li>
<li><a class="" href="column-wise.html"><span class="header-section-number">22</span> Column-wise operations</a></li>
<li class="book-part">Import</li>
<li><a class="" href="import-intro.html"><span class="header-section-number">23</span> Introduction</a></li>
<li><a class="" href="import-rectangular.html"><span class="header-section-number">24</span> Rectangular data</a></li>
<li><a class="" href="import-spreadsheets.html"><span class="header-section-number">25</span> Spreadsheets</a></li>
<li><a class="" href="import-databases.html"><span class="header-section-number">26</span> Databases</a></li>
<li><a class="" href="import-webscrape.html"><span class="header-section-number">27</span> Web scraping</a></li>
<li><a class="" href="import-other.html"><span class="header-section-number">28</span> Other types of data</a></li>
<li class="book-part">Tidy</li>
<li><a class="" href="wrangle-intro.html"><span class="header-section-number">29</span> Introduction</a></li>
<li><a class="" href="list-columns.html"><span class="header-section-number">30</span> List columns</a></li>
<li><a class="" href="rectangle-data.html"><span class="header-section-number">31</span> Data rectangling</a></li>
<li class="book-part">Program</li>
<li><a class="" href="program-intro.html"><span class="header-section-number">32</span> Introduction</a></li>
<li><a class="" href="pipes.html"><span class="header-section-number">33</span> Pipes</a></li>
<li><a class="" href="functions.html"><span class="header-section-number">34</span> Functions</a></li>
<li><a class="" href="vectors.html"><span class="header-section-number">35</span> Vectors</a></li>
<li><a class="" href="iteration.html"><span class="header-section-number">36</span> Iteration</a></li>
<li><a class="" href="programming-with-strings.html"><span class="header-section-number">37</span> Programming with strings</a></li>
<li class="book-part">Communicate</li>
<li><a class="" href="communicate-intro.html"><span class="header-section-number">38</span> Introduction</a></li>
<li><a class="" href="r-markdown.html"><span class="header-section-number">39</span> R Markdown</a></li>
<li><a class="" href="graphics-for-communication.html"><span class="header-section-number">40</span> Graphics for communication</a></li>
<li><a class="" href="r-markdown-formats.html"><span class="header-section-number">41</span> R Markdown formats</a></li>
<li><a class="" href="r-markdown-workflow.html"><span class="header-section-number">42</span> R Markdown workflow</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/hadley/r4ds">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="logicals-numbers" class="section level1" number="16">
<h1>
<span class="header-section-number">16</span> Logicals and numbers<a class="anchor" aria-label="anchor" href="#logicals-numbers"><i class="fas fa-link"></i></a>
</h1>
<div class="rmdnote">
<p>You are reading the work-in-progress second edition of R for Data Science. This chapter is currently currently a dumping ground for ideas, and we don’t recommend reading it. You can find the polished first edition at <a href="https://r4ds.had.co.nz" class="uri">https://r4ds.had.co.nz</a>.</p>
</div>
<div id="introduction-9" class="section level2" number="16.1">
<h2>
<span class="header-section-number">16.1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction-9"><i class="fas fa-link"></i></a>
</h2>
<p><code>between()</code></p>
<div class="sourceCode" id="cb273"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="co">#&gt; -- &lt;U+2029&gt;[1mAttaching packages&lt;U+2029&gt;[22m --------------------------------------- tidyverse 1.3.1 --</span>NA<span class="co">#&gt; &lt;U+2029&gt;[32mv&lt;U+2029&gt;[39m &lt;U+2029&gt;[34mggplot2&lt;U+2029&gt;[39m 3.3.5          &lt;U+2029&gt;[32mv&lt;U+2029&gt;[39m &lt;U+2029&gt;[34mpurrr  &lt;U+2029&gt;[39m 0.3.4     </span>NA<span class="co">#&gt; &lt;U+2029&gt;[32mv&lt;U+2029&gt;[39m &lt;U+2029&gt;[34mtibble &lt;U+2029&gt;[39m 3.1.2          &lt;U+2029&gt;[32mv&lt;U+2029&gt;[39m &lt;U+2029&gt;[34mdplyr  &lt;U+2029&gt;[39m 1.0.7     </span>NA<span class="co">#&gt; &lt;U+2029&gt;[32mv&lt;U+2029&gt;[39m &lt;U+2029&gt;[34mtidyr  &lt;U+2029&gt;[39m 1.1.3          &lt;U+2029&gt;[32mv&lt;U+2029&gt;[39m &lt;U+2029&gt;[34mstringr&lt;U+2029&gt;[39m 1.4.0.&lt;U+2029&gt;[31m9000&lt;U+2029&gt;[39m</span>NA<span class="co">#&gt; &lt;U+2029&gt;[32mv&lt;U+2029&gt;[39m &lt;U+2029&gt;[34mreadr  &lt;U+2029&gt;[39m 2.0.1          &lt;U+2029&gt;[32mv&lt;U+2029&gt;[39m &lt;U+2029&gt;[34mforcats&lt;U+2029&gt;[39m 0.5.1</span>NA<span class="co">#&gt; -- &lt;U+2029&gt;[1mConflicts&lt;U+2029&gt;[22m ------------------------------------------ tidyverse_conflicts() --</span>NA<span class="co">#&gt; &lt;U+2029&gt;[31mx&lt;U+2029&gt;[39m &lt;U+2029&gt;[34mdplyr&lt;U+2029&gt;[39m::&lt;U+2029&gt;[32mfilter()&lt;U+2029&gt;[39m masks &lt;U+2029&gt;[34mstats&lt;U+2029&gt;[39m::filter()</span>NA<span class="co">#&gt; &lt;U+2029&gt;[31mx&lt;U+2029&gt;[39m &lt;U+2029&gt;[34mdplyr&lt;U+2029&gt;[39m::&lt;U+2029&gt;[32mlag()&lt;U+2029&gt;[39m    masks &lt;U+2029&gt;[34mstats&lt;U+2029&gt;[39m::lag()</span>NA<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/nycflights13">nycflights13</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="logical-operators" class="section level2" number="16.2">
<h2>
<span class="header-section-number">16.2</span> Logical operators<a class="anchor" aria-label="anchor" href="#logical-operators"><i class="fas fa-link"></i></a>
</h2>
<p>Multiple arguments to <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code> are combined with “and”: every expression must be true in order for a row to be included in the output.
For other types of combinations, you’ll need to use Boolean operators yourself: <code><a href="https://rdrr.io/r/base/Logic.html">&amp;</a></code> is “and”, <code><a href="https://rdrr.io/r/base/Logic.html">|</a></code> is “or”, and <code><a href="https://rdrr.io/r/base/Logic.html">!</a></code> is “not”.
Figure <a href="logicals-numbers.html#fig:bool-ops">16.1</a> shows the complete set of Boolean operations.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:bool-ops"></span>
<img src="diagrams/transform-logical.png" alt="Six Venn diagrams, each explaining a given logical operator. The circles (sets) in each of the Venn diagrams represent x and y. 1. y &amp; !x is y but none of x, x &amp; y is the intersection of x and y, x &amp; !y is x but none of y, x is all of x none of y, xor(x, y) is everything except the intersection of x and y, y is all of y none of x, and x | y is everything." width="70%"><p class="caption">
Figure 16.1: Complete set of boolean operations. <code>x</code> is the left-hand circle, <code>y</code> is the right-hand circle, and the shaded region show which parts each operator selects.
</p>
</div>
<p>The following code finds all flights that departed in November or December:</p>
<div class="sourceCode" id="cb274"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">flights</span>, <span class="va">month</span> <span class="op">==</span> <span class="fl">11</span> <span class="op">|</span> <span class="va">month</span> <span class="op">==</span> <span class="fl">12</span><span class="op">)</span></code></pre></div>
<p>The order of operations doesn’t work like English.
You can’t write <code><a href="https://rdrr.io/r/stats/filter.html">filter(flights, month == 11 | 12)</a></code>, which you might literally translate into “finds all flights that departed in November or December”.
Instead it finds all months that equal <code>11 | 12</code>, an expression that evaluates to <code>TRUE</code>.
In a numeric context (like here), <code>TRUE</code> becomes <code>1</code>, so this finds all flights in January, not November or December.
This is quite confusing!</p>
<p>A useful short-hand for this problem is <code>x %in% y</code>.
This will select every row where <code>x</code> is one of the values in <code>y</code>.
We could use it to rewrite the code above:</p>
<div class="sourceCode" id="cb275"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nov_dec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">flights</span>, <span class="va">month</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">11</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Sometimes you can simplify complicated subsetting by remembering De Morgan’s law: <code>!(x &amp; y)</code> is the same as <code>!x | !y</code>, and <code>!(x | y)</code> is the same as <code>!x &amp; !y</code>.
For example, if you wanted to find flights that weren’t delayed (on arrival or departure) by more than two hours, you could use either of the following two filters:</p>
<div class="sourceCode" id="cb276"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">flights</span>, <span class="op">!</span><span class="op">(</span><span class="va">arr_delay</span> <span class="op">&gt;</span> <span class="fl">120</span> <span class="op">|</span> <span class="va">dep_delay</span> <span class="op">&gt;</span> <span class="fl">120</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">flights</span>, <span class="va">arr_delay</span> <span class="op">&lt;=</span> <span class="fl">120</span>, <span class="va">dep_delay</span> <span class="op">&lt;=</span> <span class="fl">120</span><span class="op">)</span></code></pre></div>
<p>As well as <code><a href="https://rdrr.io/r/base/Logic.html">&amp;</a></code> and <code><a href="https://rdrr.io/r/base/Logic.html">|</a></code>, R also has <code><a href="https://rdrr.io/r/base/Logic.html">&amp;&amp;</a></code> and <code><a href="https://rdrr.io/r/base/Logic.html">||</a></code>.
Don’t use them here!
You’ll learn when you should use them in Section <a href="functions.html#conditional-execution">34.4</a> on conditional execution.</p>
<p>Whenever you start using complicated, multipart expressions in <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code>, consider making them explicit variables instead.
That makes it much easier to check your work.
You’ll learn how to create new variables shortly.</p>
</div>
<div id="summaries" class="section level2" number="16.3">
<h2>
<span class="header-section-number">16.3</span> Summaries<a class="anchor" aria-label="anchor" href="#summaries"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>
<p>Counts and proportions of logical values: <code><a href="https://rdrr.io/r/base/sum.html">sum(x &gt; 10)</a></code>, <code><a href="https://rdrr.io/r/base/mean.html">mean(y == 0)</a></code>.
When used with numeric functions, <code>TRUE</code> is converted to 1 and <code>FALSE</code> to 0.
This makes <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code> and <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> very useful: <code><a href="https://rdrr.io/r/base/sum.html">sum(x)</a></code> gives the number of <code>TRUE</code>s in <code>x</code>, and <code><a href="https://rdrr.io/r/base/mean.html">mean(x)</a></code> gives the proportion.</p>
<div class="sourceCode" id="cb277"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">not_cancelled</span> <span class="op">&lt;-</span> <span class="va">flights</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">dep_delay</span><span class="op">)</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">arr_delay</span><span class="op">)</span><span class="op">)</span>

<span class="co"># How many flights left before 5am? (these usually indicate delayed</span>
<span class="co"># flights from the previous day)</span>
<span class="va">not_cancelled</span> <span class="op">%&gt;%</span> 
  <span class="fu">group_by</span><span class="op">(</span><span class="va">year</span>, <span class="va">month</span>, <span class="va">day</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>n_early <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">dep_time</span> <span class="op">&lt;</span> <span class="fl">500</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; `summarise()` has grouped output by 'year', 'month'. You can override using the `.groups` argument.</span>
<span class="co">#&gt; &lt;U+2029&gt;[90m# A tibble: 365 x 4&lt;U+2029&gt;[39m</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m# Groups:   year, month [12]&lt;U+2029&gt;[39m</span>NA<span class="co">#&gt;    &lt;U+2029&gt;[1myear&lt;U+2029&gt;[22m &lt;U+2029&gt;[1mmonth&lt;U+2029&gt;[22m   &lt;U+2029&gt;[1mday&lt;U+2029&gt;[22m &lt;U+2029&gt;[1mn_early&lt;U+2029&gt;[22m</span>NA<span class="co">#&gt;   &lt;U+2029&gt;[3m&lt;U+2029&gt;[90m&lt;int&gt;&lt;U+2029&gt;[39m&lt;U+2029&gt;[23m &lt;U+2029&gt;[3m&lt;U+2029&gt;[90m&lt;int&gt;&lt;U+2029&gt;[39m&lt;U+2029&gt;[23m &lt;U+2029&gt;[3m&lt;U+2029&gt;[90m&lt;int&gt;&lt;U+2029&gt;[39m&lt;U+2029&gt;[23m   &lt;U+2029&gt;[3m&lt;U+2029&gt;[90m&lt;int&gt;&lt;U+2029&gt;[39m&lt;U+2029&gt;[23m</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m1&lt;U+2029&gt;[39m  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m013     1     1       0</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m2&lt;U+2029&gt;[39m  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m013     1     2       3</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m3&lt;U+2029&gt;[39m  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m013     1     3       4</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m4&lt;U+2029&gt;[39m  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m013     1     4       3</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m5&lt;U+2029&gt;[39m  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m013     1     5       3</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m6&lt;U+2029&gt;[39m  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m013     1     6       2</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m# ... with 359 more rows&lt;U+2029&gt;[39m</span>NA<span class="co"># What proportion of flights are delayed by more than an hour?</span>
<span class="va">not_cancelled</span> <span class="op">%&gt;%</span> 
  <span class="fu">group_by</span><span class="op">(</span><span class="va">year</span>, <span class="va">month</span>, <span class="va">day</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>hour_prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">arr_delay</span> <span class="op">&gt;</span> <span class="fl">60</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; `summarise()` has grouped output by 'year', 'month'. You can override using the `.groups` argument.</span>
<span class="co">#&gt; &lt;U+2029&gt;[90m# A tibble: 365 x 4&lt;U+2029&gt;[39m</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m# Groups:   year, month [12]&lt;U+2029&gt;[39m</span>NA<span class="co">#&gt;    &lt;U+2029&gt;[1myear&lt;U+2029&gt;[22m &lt;U+2029&gt;[1mmonth&lt;U+2029&gt;[22m   &lt;U+2029&gt;[1mday&lt;U+2029&gt;[22m &lt;U+2029&gt;[1mhour_prop&lt;U+2029&gt;[22m</span>NA<span class="co">#&gt;   &lt;U+2029&gt;[3m&lt;U+2029&gt;[90m&lt;int&gt;&lt;U+2029&gt;[39m&lt;U+2029&gt;[23m &lt;U+2029&gt;[3m&lt;U+2029&gt;[90m&lt;int&gt;&lt;U+2029&gt;[39m&lt;U+2029&gt;[23m &lt;U+2029&gt;[3m&lt;U+2029&gt;[90m&lt;int&gt;&lt;U+2029&gt;[39m&lt;U+2029&gt;[23m     &lt;U+2029&gt;[3m&lt;U+2029&gt;[90m&lt;dbl&gt;&lt;U+2029&gt;[39m&lt;U+2029&gt;[23m</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m1&lt;U+2029&gt;[39m  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m013     1     1    0.072&lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m2&lt;U+2029&gt;[39m  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m013     1     2    0.085&lt;U+2029&gt;[4m1&lt;U+2029&gt;[24m</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m3&lt;U+2029&gt;[39m  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m013     1     3    0.056&lt;U+2029&gt;[4m7&lt;U+2029&gt;[24m</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m4&lt;U+2029&gt;[39m  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m013     1     4    0.039&lt;U+2029&gt;[4m6&lt;U+2029&gt;[24m</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m5&lt;U+2029&gt;[39m  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m013     1     5    0.034&lt;U+2029&gt;[4m9&lt;U+2029&gt;[24m</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m6&lt;U+2029&gt;[39m  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m013     1     6    0.047&lt;U+2029&gt;[4m0&lt;U+2029&gt;[24m</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m# ... with 359 more rows&lt;U+2029&gt;[39m</span>NA</code></pre></div>
</li>
</ul>
<p><code>cumany()</code> <code>cumall()</code></p>
<div id="exercises-28" class="section level3" number="16.3.1">
<h3>
<span class="header-section-number">16.3.1</span> Exercises<a class="anchor" aria-label="anchor" href="#exercises-28"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>For each plane, count the number of flights before the first delay of greater than 1 hour.</li>
</ol>
</div>
</div>
<div id="basic-math" class="section level2" number="16.4">
<h2>
<span class="header-section-number">16.4</span> Basic math<a class="anchor" aria-label="anchor" href="#basic-math"><i class="fas fa-link"></i></a>
</h2>
<p>There are many functions for creating new variables that you can use with <code>mutate()</code>.
The key property is that the function must be vectorised: it must take a vector of values as input, return a vector with the same number of values as output.
There’s no way to list every possible function that you might use, but here’s a selection of functions that are frequently useful:</p>
<ul>
<li>
<p>Arithmetic operators: <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code>, <code><a href="https://rdrr.io/r/base/Arithmetic.html">-</a></code>, <code><a href="https://rdrr.io/r/base/Arithmetic.html">*</a></code>, <code><a href="https://rdrr.io/r/base/Arithmetic.html">/</a></code>, <code><a href="https://rdrr.io/r/base/Arithmetic.html">^</a></code>.
These are all vectorised, using the so called “recycling rules”.
If one parameter is shorter than the other, it will be automatically extended to be the same length.
This is most useful when one of the arguments is a single number: <code>air_time / 60</code>, <code>hours * 60 + minute</code>, etc.</p>
<p>Arithmetic operators are also useful in conjunction with the aggregate functions you’ll learn about later.
For example, <code>x / sum(x)</code> calculates the proportion of a total, and <code>y - mean(y)</code> computes the difference from the mean.</p>
</li>
<li>
<p>Modular arithmetic: <code><a href="https://rdrr.io/r/base/Arithmetic.html">%/%</a></code> (integer division) and <code><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></code> (remainder), where <code>x == y * (x %/% y) + (x %% y)</code>.
Modular arithmetic is a handy tool because it allows you to break integers up into pieces.
For example, in the flights dataset, you can compute <code>hour</code> and <code>minute</code> from <code>dep_time</code> with:</p>
<div class="sourceCode" id="cb278"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">transmute</span><span class="op">(</span><span class="va">flights</span>,
  <span class="va">dep_time</span>,
  hour <span class="op">=</span> <span class="va">dep_time</span> <span class="op">%/%</span> <span class="fl">100</span>,
  minute <span class="op">=</span> <span class="va">dep_time</span> <span class="op">%%</span> <span class="fl">100</span>
<span class="op">)</span>
<span class="co">#&gt; &lt;U+2029&gt;[90m# A tibble: 336,776 x 3&lt;U+2029&gt;[39m</span>NA<span class="co">#&gt;   &lt;U+2029&gt;[1mdep_time&lt;U+2029&gt;[22m  &lt;U+2029&gt;[1mhour&lt;U+2029&gt;[22m &lt;U+2029&gt;[1mminute&lt;U+2029&gt;[22m</span>NA<span class="co">#&gt;      &lt;U+2029&gt;[3m&lt;U+2029&gt;[90m&lt;int&gt;&lt;U+2029&gt;[39m&lt;U+2029&gt;[23m &lt;U+2029&gt;[3m&lt;U+2029&gt;[90m&lt;dbl&gt;&lt;U+2029&gt;[39m&lt;U+2029&gt;[23m  &lt;U+2029&gt;[3m&lt;U+2029&gt;[90m&lt;dbl&gt;&lt;U+2029&gt;[39m&lt;U+2029&gt;[23m</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m1&lt;U+2029&gt;[39m      517     5     17</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m2&lt;U+2029&gt;[39m      533     5     33</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m3&lt;U+2029&gt;[39m      542     5     42</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m4&lt;U+2029&gt;[39m      544     5     44</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m5&lt;U+2029&gt;[39m      554     5     54</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m6&lt;U+2029&gt;[39m      554     5     54</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m# ... with 336,770 more rows&lt;U+2029&gt;[39m</span>NA</code></pre></div>
</li>
<li>
<p>Logs: <code><a href="https://rdrr.io/r/base/Log.html">log()</a></code>, <code><a href="https://rdrr.io/r/base/Log.html">log2()</a></code>, <code><a href="https://rdrr.io/r/base/Log.html">log10()</a></code>.
Logarithms are an incredibly useful transformation for dealing with data that ranges across multiple orders of magnitude.
They also convert multiplicative relationships to additive.</p>
<p>All else being equal, I recommend using <code><a href="https://rdrr.io/r/base/Log.html">log2()</a></code> because it’s easy to interpret: a difference of 1 on the log scale corresponds to doubling on the original scale and a difference of -1 corresponds to halving.</p>
</li>
<li><p>Logical comparisons: <code><a href="https://rdrr.io/r/base/Comparison.html">&lt;</a></code>, <code><a href="https://rdrr.io/r/base/Comparison.html">&lt;=</a></code>, <code><a href="https://rdrr.io/r/base/Comparison.html">&gt;</a></code>, <code><a href="https://rdrr.io/r/base/Comparison.html">&gt;=</a></code>, <code><a href="https://rdrr.io/r/base/Comparison.html">!=</a></code>, and <code><a href="https://rdrr.io/r/base/Comparison.html">==</a></code>, which you learned about earlier.
If you’re doing a complex sequence of logical operations it’s often a good idea to store the interim values in new variables so you can check that each step is working as expected.</p></li>
<li>
<p>Cumulative and rolling aggregates: R provides functions for running sums, products, mins and maxes: <code><a href="https://rdrr.io/r/base/cumsum.html">cumsum()</a></code>, <code><a href="https://rdrr.io/r/base/cumsum.html">cumprod()</a></code>, <code><a href="https://rdrr.io/r/base/cumsum.html">cummin()</a></code>, <code><a href="https://rdrr.io/r/base/cumsum.html">cummax()</a></code>; and dplyr provides <code>cummean()</code> for cumulative means.
If you need rolling aggregates (i.e. a sum computed over a rolling window), try the RcppRoll package.</p>
<div class="sourceCode" id="cb279"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>
<span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt;  [1]  1  3  6 10 15 21 28 36 45 55</span>
<span class="fu">cummean</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt;  [1] 1.0 1.5 2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5</span></code></pre></div>
</li>
</ul>
<div id="recycling-rules" class="section level3" number="16.4.1">
<h3>
<span class="header-section-number">16.4.1</span> Recycling rules<a class="anchor" aria-label="anchor" href="#recycling-rules"><i class="fas fa-link"></i></a>
</h3>
<p>Base R.</p>
<p>Tidyverse.</p>
</div>
</div>
<div id="summaries-1" class="section level2" number="16.5">
<h2>
<span class="header-section-number">16.5</span> Summaries<a class="anchor" aria-label="anchor" href="#summaries-1"><i class="fas fa-link"></i></a>
</h2>
<p>Just using means, counts, and sum can get you a long way, but R provides many other useful summary functions:</p>
<ul>
<li>
<p>Measures of location: we’ve used <code><a href="https://rdrr.io/r/base/mean.html">mean(x)</a></code>, but <code><a href="https://rdrr.io/r/stats/median.html">median(x)</a></code> is also useful.
The mean is the sum divided by the length; the median is a value where 50% of <code>x</code> is above it, and 50% is below it.</p>
<div class="sourceCode" id="cb280"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">not_cancelled</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">month</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise</span><span class="op">(</span>
    med_arr_delay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">arr_delay</span><span class="op">)</span>,
    med_dep_delay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">dep_delay</span><span class="op">)</span>
    <span class="op">)</span>
<span class="co">#&gt; &lt;U+2029&gt;[90m# A tibble: 12 x 3&lt;U+2029&gt;[39m</span>NA<span class="co">#&gt;   &lt;U+2029&gt;[1mmonth&lt;U+2029&gt;[22m &lt;U+2029&gt;[1mmed_arr_delay&lt;U+2029&gt;[22m &lt;U+2029&gt;[1mmed_dep_delay&lt;U+2029&gt;[22m</span>NA<span class="co">#&gt;   &lt;U+2029&gt;[3m&lt;U+2029&gt;[90m&lt;int&gt;&lt;U+2029&gt;[39m&lt;U+2029&gt;[23m         &lt;U+2029&gt;[3m&lt;U+2029&gt;[90m&lt;dbl&gt;&lt;U+2029&gt;[39m&lt;U+2029&gt;[23m         &lt;U+2029&gt;[3m&lt;U+2029&gt;[90m&lt;dbl&gt;&lt;U+2029&gt;[39m&lt;U+2029&gt;[23m</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m1&lt;U+2029&gt;[39m     1            -&lt;U+2029&gt;[31m3&lt;U+2029&gt;[39m            -&lt;U+2029&gt;[31m2&lt;U+2029&gt;[39m</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m2&lt;U+2029&gt;[39m     2            -&lt;U+2029&gt;[31m3&lt;U+2029&gt;[39m            -&lt;U+2029&gt;[31m2&lt;U+2029&gt;[39m</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m3&lt;U+2029&gt;[39m     3            -&lt;U+2029&gt;[31m6&lt;U+2029&gt;[39m            -&lt;U+2029&gt;[31m1&lt;U+2029&gt;[39m</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m4&lt;U+2029&gt;[39m     4            -&lt;U+2029&gt;[31m2&lt;U+2029&gt;[39m            -&lt;U+2029&gt;[31m2&lt;U+2029&gt;[39m</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m5&lt;U+2029&gt;[39m     5            -&lt;U+2029&gt;[31m8&lt;U+2029&gt;[39m            -&lt;U+2029&gt;[31m1&lt;U+2029&gt;[39m</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m6&lt;U+2029&gt;[39m     6            -&lt;U+2029&gt;[31m2&lt;U+2029&gt;[39m             0</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m# ... with 6 more rows&lt;U+2029&gt;[39m</span>NA</code></pre></div>
<p>It’s sometimes useful to combine aggregation with logical subsetting.
We haven’t talked about this sort of subsetting yet, but you’ll learn more about it in Section <a href="vectors.html#vector-subsetting">35.4.5</a>.</p>
<div class="sourceCode" id="cb281"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">not_cancelled</span> <span class="op">%&gt;%</span> 
  <span class="fu">group_by</span><span class="op">(</span><span class="va">year</span>, <span class="va">month</span>, <span class="va">day</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>
    avg_delay1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">arr_delay</span><span class="op">)</span>,
    avg_delay2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">arr_delay</span><span class="op">[</span><span class="va">arr_delay</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span> <span class="co"># the average positive delay</span>
  <span class="op">)</span>
<span class="co">#&gt; `summarise()` has grouped output by 'year', 'month'. You can override using the `.groups` argument.</span>
<span class="co">#&gt; &lt;U+2029&gt;[90m# A tibble: 365 x 5&lt;U+2029&gt;[39m</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m# Groups:   year, month [12]&lt;U+2029&gt;[39m</span>NA<span class="co">#&gt;    &lt;U+2029&gt;[1myear&lt;U+2029&gt;[22m &lt;U+2029&gt;[1mmonth&lt;U+2029&gt;[22m   &lt;U+2029&gt;[1mday&lt;U+2029&gt;[22m &lt;U+2029&gt;[1mavg_delay1&lt;U+2029&gt;[22m &lt;U+2029&gt;[1mavg_delay2&lt;U+2029&gt;[22m</span>NA<span class="co">#&gt;   &lt;U+2029&gt;[3m&lt;U+2029&gt;[90m&lt;int&gt;&lt;U+2029&gt;[39m&lt;U+2029&gt;[23m &lt;U+2029&gt;[3m&lt;U+2029&gt;[90m&lt;int&gt;&lt;U+2029&gt;[39m&lt;U+2029&gt;[23m &lt;U+2029&gt;[3m&lt;U+2029&gt;[90m&lt;int&gt;&lt;U+2029&gt;[39m&lt;U+2029&gt;[23m      &lt;U+2029&gt;[3m&lt;U+2029&gt;[90m&lt;dbl&gt;&lt;U+2029&gt;[39m&lt;U+2029&gt;[23m      &lt;U+2029&gt;[3m&lt;U+2029&gt;[90m&lt;dbl&gt;&lt;U+2029&gt;[39m&lt;U+2029&gt;[23m</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m1&lt;U+2029&gt;[39m  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m013     1     1      12.7        32.5</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m2&lt;U+2029&gt;[39m  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m013     1     2      12.7        32.0</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m3&lt;U+2029&gt;[39m  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m013     1     3       5.73       27.7</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m4&lt;U+2029&gt;[39m  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m013     1     4      -&lt;U+2029&gt;[31m1&lt;U+2029&gt;[39m&lt;U+2029&gt;[31m.&lt;U+2029&gt;[39m&lt;U+2029&gt;[31m93&lt;U+2029&gt;[39m       28.3</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m5&lt;U+2029&gt;[39m  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m013     1     5      -&lt;U+2029&gt;[31m1&lt;U+2029&gt;[39m&lt;U+2029&gt;[31m.&lt;U+2029&gt;[39m&lt;U+2029&gt;[31m53&lt;U+2029&gt;[39m       22.6</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m6&lt;U+2029&gt;[39m  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m013     1     6       4.24       24.4</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m# ... with 359 more rows&lt;U+2029&gt;[39m</span>NA</code></pre></div>
</li>
<li>
<p>Measures of spread: <code><a href="https://rdrr.io/r/stats/sd.html">sd(x)</a></code>, <code><a href="https://rdrr.io/r/stats/IQR.html">IQR(x)</a></code>, <code><a href="https://rdrr.io/r/stats/mad.html">mad(x)</a></code>.
The root mean squared deviation, or standard deviation <code><a href="https://rdrr.io/r/stats/sd.html">sd(x)</a></code>, is the standard measure of spread.
The interquartile range <code><a href="https://rdrr.io/r/stats/IQR.html">IQR(x)</a></code> and median absolute deviation <code><a href="https://rdrr.io/r/stats/mad.html">mad(x)</a></code> are robust equivalents that may be more useful if you have outliers.</p>
<div class="sourceCode" id="cb282"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Why is distance to some destinations more variable than to others?</span>
<span class="va">not_cancelled</span> <span class="op">%&gt;%</span> 
  <span class="fu">group_by</span><span class="op">(</span><span class="va">dest</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>distance_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">distance</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">distance_sd</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; &lt;U+2029&gt;[90m# A tibble: 104 x 2&lt;U+2029&gt;[39m</span>NA<span class="co">#&gt;   &lt;U+2029&gt;[1mdest&lt;U+2029&gt;[22m  &lt;U+2029&gt;[1mdistance_sd&lt;U+2029&gt;[22m</span>NA<span class="co">#&gt;   &lt;U+2029&gt;[3m&lt;U+2029&gt;[90m&lt;chr&gt;&lt;U+2029&gt;[39m&lt;U+2029&gt;[23m       &lt;U+2029&gt;[3m&lt;U+2029&gt;[90m&lt;dbl&gt;&lt;U+2029&gt;[39m&lt;U+2029&gt;[23m</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m1&lt;U+2029&gt;[39m EGE         10.5 </span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m2&lt;U+2029&gt;[39m SAN         10.4 </span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m3&lt;U+2029&gt;[39m SFO         10.2 </span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m4&lt;U+2029&gt;[39m HNL         10.0 </span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m5&lt;U+2029&gt;[39m SEA          9.98</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m6&lt;U+2029&gt;[39m LAS          9.91</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m# ... with 98 more rows&lt;U+2029&gt;[39m</span>NA</code></pre></div>
</li>
<li>
<p>Measures of rank: <code><a href="https://rdrr.io/r/base/Extremes.html">min(x)</a></code>, <code><a href="https://rdrr.io/r/stats/quantile.html">quantile(x, 0.25)</a></code>, <code><a href="https://rdrr.io/r/base/Extremes.html">max(x)</a></code>.
Quantiles are a generalisation of the median.
For example, <code><a href="https://rdrr.io/r/stats/quantile.html">quantile(x, 0.25)</a></code> will find a value of <code>x</code> that is greater than 25% of the values, and less than the remaining 75%.</p>
<div class="sourceCode" id="cb283"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># When do the first and last flights leave each day?</span>
<span class="va">not_cancelled</span> <span class="op">%&gt;%</span> 
  <span class="fu">group_by</span><span class="op">(</span><span class="va">year</span>, <span class="va">month</span>, <span class="va">day</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>
    first <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">dep_time</span><span class="op">)</span>,
    last <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">dep_time</span><span class="op">)</span>
  <span class="op">)</span>
<span class="co">#&gt; `summarise()` has grouped output by 'year', 'month'. You can override using the `.groups` argument.</span>
<span class="co">#&gt; &lt;U+2029&gt;[90m# A tibble: 365 x 5&lt;U+2029&gt;[39m</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m# Groups:   year, month [12]&lt;U+2029&gt;[39m</span>NA<span class="co">#&gt;    &lt;U+2029&gt;[1myear&lt;U+2029&gt;[22m &lt;U+2029&gt;[1mmonth&lt;U+2029&gt;[22m   &lt;U+2029&gt;[1mday&lt;U+2029&gt;[22m &lt;U+2029&gt;[1mfirst&lt;U+2029&gt;[22m  &lt;U+2029&gt;[1mlast&lt;U+2029&gt;[22m</span>NA<span class="co">#&gt;   &lt;U+2029&gt;[3m&lt;U+2029&gt;[90m&lt;int&gt;&lt;U+2029&gt;[39m&lt;U+2029&gt;[23m &lt;U+2029&gt;[3m&lt;U+2029&gt;[90m&lt;int&gt;&lt;U+2029&gt;[39m&lt;U+2029&gt;[23m &lt;U+2029&gt;[3m&lt;U+2029&gt;[90m&lt;int&gt;&lt;U+2029&gt;[39m&lt;U+2029&gt;[23m &lt;U+2029&gt;[3m&lt;U+2029&gt;[90m&lt;int&gt;&lt;U+2029&gt;[39m&lt;U+2029&gt;[23m &lt;U+2029&gt;[3m&lt;U+2029&gt;[90m&lt;int&gt;&lt;U+2029&gt;[39m&lt;U+2029&gt;[23m</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m1&lt;U+2029&gt;[39m  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m013     1     1   517  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m356</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m2&lt;U+2029&gt;[39m  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m013     1     2    42  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m354</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m3&lt;U+2029&gt;[39m  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m013     1     3    32  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m349</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m4&lt;U+2029&gt;[39m  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m013     1     4    25  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m358</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m5&lt;U+2029&gt;[39m  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m013     1     5    14  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m357</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m6&lt;U+2029&gt;[39m  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m013     1     6    16  &lt;U+2029&gt;[4m2&lt;U+2029&gt;[24m355</span>NA<span class="co">#&gt; &lt;U+2029&gt;[90m# ... with 359 more rows&lt;U+2029&gt;[39m</span>NA</code></pre></div>
</li>
</ul>
<div id="exercises-29" class="section level3" number="16.5.1">
<h3>
<span class="header-section-number">16.5.1</span> Exercises<a class="anchor" aria-label="anchor" href="#exercises-29"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<p>Brainstorm at least 5 different ways to assess the typical delay characteristics of a group of flights.
Consider the following scenarios:</p>
<ul>
<li><p>A flight is 15 minutes early 50% of the time, and 15 minutes late 50% of the time.</p></li>
<li><p>A flight is always 10 minutes late.</p></li>
<li><p>A flight is 30 minutes early 50% of the time, and 30 minutes late 50% of the time.</p></li>
<li><p>99% of the time a flight is on time.
1% of the time it’s 2 hours late.</p></li>
</ul>
<p>Which is more important: arrival delay or departure delay?</p>
</li>
</ol>
</div>
</div>
<div id="floating-point" class="section level2" number="16.6">
<h2>
<span class="header-section-number">16.6</span> Floating point<a class="anchor" aria-label="anchor" href="#floating-point"><i class="fas fa-link"></i></a>
</h2>
<p>There’s another common problem you might encounter when using <code><a href="https://rdrr.io/r/base/Comparison.html">==</a></code>: floating point numbers.
These results might surprise you!</p>
<div class="sourceCode" id="cb284"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">49</span> <span class="op">*</span> <span class="fl">49</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span>
<span class="co">#&gt; [1] FALSE</span></code></pre></div>
<p>Computers use finite precision arithmetic (they obviously can’t store an infinite number of digits!) so remember that every number you see is an approximation.
Instead of relying on <code><a href="https://rdrr.io/r/base/Comparison.html">==</a></code>, use <code>near()</code>:</p>
<div class="sourceCode" id="cb285"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">near</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span>,  <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="fu">near</span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">49</span> <span class="op">*</span> <span class="fl">49</span>, <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
</div>
<div id="exercises-30" class="section level2" number="16.7">
<h2>
<span class="header-section-number">16.7</span> Exercises<a class="anchor" aria-label="anchor" href="#exercises-30"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>What trigonometric functions does R provide?</li>
<li>
</ol>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="vector-tools.html"><span class="header-section-number">15</span> Vector tools</a></div>
<div class="next"><a href="missing-values.html"><span class="header-section-number">17</span> Missing values</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#logicals-numbers"><span class="header-section-number">16</span> Logicals and numbers</a></li>
<li><a class="nav-link" href="#introduction-9"><span class="header-section-number">16.1</span> Introduction</a></li>
<li><a class="nav-link" href="#logical-operators"><span class="header-section-number">16.2</span> Logical operators</a></li>
<li>
<a class="nav-link" href="#summaries"><span class="header-section-number">16.3</span> Summaries</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#exercises-28"><span class="header-section-number">16.3.1</span> Exercises</a></li></ul>
</li>
<li>
<a class="nav-link" href="#basic-math"><span class="header-section-number">16.4</span> Basic math</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#recycling-rules"><span class="header-section-number">16.4.1</span> Recycling rules</a></li></ul>
</li>
<li>
<a class="nav-link" href="#summaries-1"><span class="header-section-number">16.5</span> Summaries</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#exercises-29"><span class="header-section-number">16.5.1</span> Exercises</a></li></ul>
</li>
<li><a class="nav-link" href="#floating-point"><span class="header-section-number">16.6</span> Floating point</a></li>
<li><a class="nav-link" href="#exercises-30"><span class="header-section-number">16.7</span> Exercises</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/hadley/r4ds/blob/master/logicals-numbers.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/hadley/r4ds/edit/master/logicals-numbers.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R for Data Science (2e)</strong>" was written by Hadley Wickham and Garrett Grolemund. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
